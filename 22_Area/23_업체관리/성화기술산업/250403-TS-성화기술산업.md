### 성화기술산업 접이식&고정식 전광판 구성

- 데이터 전송과 표출은 다음의 순서로 진행
	- (1) 성화터치패널(문구표출버튼/꺼짐버튼)
	- (2) 마이컴(명령패킷전송)
	- (3) 다빛컨트롤러
	- ![[as_성화_250403_2.png]]
- 다빛컨트롤러 리셋 상황
	- (1) 성화터치패널에서 
	- 음주단속중, 교통통제중 등 **문구표출버튼**을 눌러 좌/우측 화살표 이동효과 중
	- **꺼짐버튼**을 누르고 다시 **문구표출버튼**을 눌렀을 때 리셋
	- ![[KakaoTalk_20250403_215501187.mp4]]
### (2) 마이컴 --(TX)--> (3) 다빛컨트롤러 패킷 분석
```
문구표출 버튼 + Relay ON
<![005099!]       ## 전광판 밝기 99(최대)
<![005099!]
<![005099!]
<![005099!]
<![0054 50!]      ## 배경이미지 표출속도 50
<![0054 50!]
<![0020002 028!]  ## 002번 028번 배경이미지 표출
<![0054 03!]      ## 배경이미지 표출속도 03
<![0020022!]      ## 022번 배경이미지 표출
꺼짐버튼 + Relay OFF

문구표출 버튼 + Relay ON
<![005099!]
<![005099!]
<![005099!]
<![005099!]
<![0054 50!]
<![0054 50!]
<![0020002 028!]
<![0054 03!]
<![0020022!]
<![0054 50!]
꺼짐버튼 + Relay OFF

문구표출 버튼 + Relay ON
<![005099!]
<![005099!]
<![005099!]
<![005099!]
<![005099!]
<![0054 50!]
<![0054 50!]
<![0054 50!]
<![0020002 028!]
꺼짐버튼 + Relay OFF
```
- 패킷 분석 토론
	- 다빛: `![005099!]`가 4번, `![0054 50!]` 2번 전송되는데 왜 그런지?
	- 성화: 다빛컨트롤러에서 응답이 안와서 계속 보내는 것.  그렇게 세팅을 했음
	- 다빛: 컨트롤러 기본 밝기가 99인데 전광판 밝기 패킷을 보내는 이유는?
	- 성화: 밝기설정이 중요해서 보내는 것, 다빛컨트롤러 응답 패킷을 보자 


### (2) 마이컴 --(TX/RX)--> (3) 다빛컨트롤러 패킷 분석
#### 세팅
- SerialPortMon으로 TX/RX 포트 세팅
- (1) 성화터치패널 꺼짐 버튼 누르고 
- SerialPortMon 로그 삭제
- 문구표출 버튼 눌렀을 때, SerialPortMon 좌측(TX), 우측(RX)

![[as_성화_250403_1.png]]
#### 원인 분석
- (1) 성화터치패널에서 꺼짐버튼 -> 다빛컨트롤러/LED 모듈 꺼짐
- 문구표출버튼을 눌렀을때, 아래의 두 과정이 동시에 발생
	- TX: (2) 마이컴 -> (3) 다빛컨트롤러로 `![005099]` 전송 
	- RX: (3) 다빛컨트롤러 시스템 초기화
- (3) 다빛컨트롤러가 껐다 켜질 때 시스템 초기화 중에 `![005099!]` 패킷이 전송되어 간헐적으로 컨트롤러가 리셋되는 현상이 발생된 것으로 추측
#### 논의 및 해결책 제안
- 다빛의 해결책 제안 1
	1. 꺼짐상태 
	2. 성화터치패널에서 문구표출버튼을 눌렀을 때 
	3. 다빛컨트롤러의 초기화가 끝나는 `[0/1]` 메시지가 나오면 
	4. 마이컴 --> 다빛컨트롤러로 `![005099!]` 패킷 전송하도록 마이컴 코드 변경
- 다빛의 해결책 제안 2
	1. 성화터치패널에 켜기 버튼을 만들어 켜기를 누르면 
	2. 다빛컨트롤러에 전원을 인가
	3. 문구표출버튼을 눌러 데이터 전송
