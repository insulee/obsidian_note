---
share_link: https://share.note.sx/20te4aku#pSNlKfMx4VtOuz2Pb+dFtDyXgzionVQfdLMHdvhpksQ
share_updated: 2025-05-19T07:52:43+09:00
---
## 1. 패킷 프레임 구조

- 각 전송 패킷은 **14바이트**로 구성
- **총 길이:** 14바이트 = 7바이트 × 2
- **구성:**
    1. **서브패킷 A (앞 7바이트):** 호출할 숫자의 “십(十)의 자리"
    2. **서브패킷 B (뒤 7바이트):** 호출할 숫자의 “일(一)의 자리”
- 예를 들어, 숫자 **“11”** 호출 시
	- A: `Message ID = 0x31` → 십의 자리 “1”
	- B: `Message ID = 0x31` → 일의 자리 “1”

| 순서  | 필드         | 길이(바이트) |     값 예시      | 설명                            |
| :-: | :--------- | :-----: | :-----------: | :---------------------------- |
|  1  | STX        |    1    |    `0x02`     | 패킷 시작 표시 (Start of Text)      |
|  2  | Address    |    1    |    `0x03`     | ~~장비 주소 (Controller ID)~~     |
|  3  | Command    |    1    |    `0x52`     | ~~호출 명령 코드 (‘R’: 메모리 문구 호출)~~ |
|  4  | Reserved   |    1    |    `0x00`     | ~~예약 필드(항상 0)~~               |
|  5  | Message ID |    1    | `0x30`~`0x39` | 호출할 문구 번호                     |
|  6  | CheckSum   |    1    |   `0x58` 등    | CRC-8 체크섬                     |
|  7  | ETX        |    1    |    `0x03`     | 패킷 종료 표시 (End of Text)        |

| 호출 숫자  | 서브 A (십의 자리) | 서브 B (일의 자리) | 전체 14바이트                                         |
| :----: | :----------: | :----------: | :----------------------------------------------- |
| **1**  |  `0x30` (0)  |  `0x31` (1)  | `02 03 52 00 30 58 03`<br>`02 03 52 00 31 5F 03` |
| **2**  |  `0x30` (0)  |  `0x32` (2)  | `02 03 52 00 30 58 03`<br>`02 03 52 00 32 56 03` |
| **3**  |  `0x30` (0)  |  `0x33` (3)  | `02 03 52 00 30 58 03`<br>`02 03 52 00 33 51 03` |
| **4**  |  `0x30` (0)  |  `0x34` (4)  | `02 03 52 00 30 58 03`<br>`02 03 52 00 34 44 03` |
| **5**  |  `0x30` (0)  |  `0x35` (5)  | `02 03 52 00 30 58 03`<br>`02 03 52 00 35 43 03` |
| **6**  |  `0x30` (0)  |  `0x36` (6)  | `02 03 52 00 30 58 03`<br>`02 03 52 00 36 4A 03` |
| **7**  |  `0x30` (0)  |  `0x37` (7)  | `02 03 52 00 30 58 03`<br>`02 03 52 00 37 4D 03` |
| **8**  |  `0x30` (0)  |  `0x38` (8)  | `02 03 52 00 30 58 03`<br>`02 03 52 00 38 60 03` |
| **9**  |  `0x30` (0)  |  `0x39` (9)  | `02 03 52 00 30 58 03`<br>`02 03 52 00 39 67 03` |
| **10** |  `0x31` (1)  |  `0x30` (0)  | `02 03 52 00 31 5F 03`<br>`02 03 52 00 30 58 03` |
| **11** |  `0x31` (1)  |  `0x31` (1)  | `02 03 52 00 31 5F 03`<br>`02 03 52 00 31 5F 03` |
| **12** |  `0x31` (1)  |  `0x32` (2)  | `02 03 52 00 31 5F 03`<br>`02 03 52 00 32 56 03` |

---
## 2. 프로토콜 패킷 (컨트롤박스 -> 컨트롤러)


#### 1번
- 패킷
    ```
    02 03 52 00 30 58 03 02 03 52 00 31 5F 03
    ```
- 문구: 양보해 주셔서 감사합니다
- 효과: 흰색, 우->좌로 이동하기

#### 2번
- 패킷
    ```
    02 03 52 00 30 58 03 02 03 52 00 32 56 03
    ```
- 문구: 사고 수습 중 입니다. 우회하세요. →→→
- 효과: 흰색, 우->좌로 이동하기

#### 3번
- 패킷
    ```
    02 03 52 00 30 58 03 02 03 52 00 33 51 03
    ```
- 문구: ←←← 사고 수습 중 입니다. 우회하세요. 
- 효과: 흰색, 좌->우로 이동하기

#### 4번
- 패킷
    ```
    02 03 52 00 30 58 03 02 03 52 00 34 44 03
    ```
- 문구: 응급 출동 중 입니다.
- 효과: 흰색, 좌->우로 이동하기

#### 5번
- 패킷
    ```
    02 03 52 00 30 58 03 02 03 52 00 35 43 03
    ``` 
- 문구: 급정거에 주의하세요.
- 효과: 흰색, 좌->우로 이동하기

#### 6번
- 패킷
    ```
    02 03 52 00 30 58 03 02 03 52 00 36 4A 03
    ```
- 문구: 없음
- 효과: 빨간색 배경깜빡이기

#### 7번
- 패킷
    ```
    02 03 52 00 30 58 03 02 03 52 00 37 4D 03
    ```
- 문구: 전방 ! 주의
- 효과: 빨간색, 글씨깜빡이기

#### 8번
- 패킷
    ```
    02 03 52 00 30 58 03 02 03 52 00 38 60 03
    ```
- 문구: <<< <<< <<< <<< 적색
- 효과: 닦아내기, 왼쪽

#### 9번
- 패킷
    ```
    02 03 52 00 30 58 03 02 03 52 00 39 67 03
    ```
- 문구: >>> >>> >>> >>> 적색
- 효과: 닦아내기, 오른쪽

#### 10번 (사용안함)
- 패킷
    ```
    02 03 52 00 31 5F 03 02 03 52 00 30 58 03
    ```
- 문구: 없음
- 효과: 없음

#### 11번
- 패킷
    ```
    02 03 52 00 31 5F 03 02 03 52 00 31 5F 03
    ```
- 문구: 사용자지정 
- 효과: 사용자지정

#### 12번
- 패킷
    ```
    02 03 52 00 31 5F 03 02 03 52 00 32 56 03
    ```
- 문구: 사용자지정
- 효과: 사용자지정



    
## 3. 패킷 번호별 다빛솔루션 프로토콜 매핑



| 번호  |                        패킷                        | 문구 예시                  | ASCII 프로토콜    |
| :-: | :----------------------------------------------: | :--------------------- | :------------ |
| 01  | `02 03 52 00 30 58 03`<br>`02 03 52 00 31 5F 03` | 양보해 주셔서 감사합니다.         | `![0020001!]` |
| 02  | `02 03 52 00 30 58 03`<br>`02 03 52 00 32 56 03` | 사고 수습 중 입니다. 우회하세요 →→→ | `![0020002!]` |
| 03  | `02 03 52 00 30 58 03`<br>`02 03 52 00 33 51 03` | ←←← 사고 수습 중 입니다. 우회하세요 | `![0020003!]` |
| 04  | `02 03 52 00 30 58 03`<br>`02 03 52 00 34 44 03` | 응급 출동 중 입니다.           | `![0020004!]` |
| 05  | `02 03 52 00 30 58 03`<br>`02 03 52 00 35 43 03` | 급정거에 주의하세요.            | `![0020005!]` |
| 06  | `02 03 52 00 30 58 03`<br>`02 03 52 00 36 4A 03` | (적색 전체 점멸)             | `![0020006!]` |
| 07  | `02 03 52 00 30 58 03`<br>`02 03 52 00 37 4D 03` | 전방 ! 주의                | `![0020007!]` |
| 08  | `02 03 52 00 30 58 03`<br>`02 03 52 00 38 60 03` | <<< <<< <<< <<<        | `![0020008!]` |
| 09  | `02 03 52 00 30 58 03`<br>`02 03 52 00 39 67 03` | >>> >>> >>> >>>        | `![0020009!]` |
| 10  | `02 03 52 00 31 5F 03`<br>`02 03 52 00 30 58 03` | 없음                     | 없음            |
| 11  | `02 03 52 00 31 5F 03`<br>`02 03 52 00 31 5F 03` | 사용자 입력 문구              |               |
| 12  | `02 03 52 00 31 5F 03`<br>`02 03 52 00 32 56 03` | 사용자 입력 문구              |               |


## (참고) 체크섬(CheckSum) 계산 방법

체크섬은 **Address → Command → Reserved → Message ID** 네 바이트에 대해 **CRC-8 (다항식 0x07, Init=0x00, RefIn=false, RefOut=false, XorOut=0x00)** 방식으로 산출합니다 ([위키백과](https://en.wikipedia.org/wiki/Cyclic_redundancy_check?utm_source=chatgpt.com "Cyclic redundancy check"), [sunshine2k.de](https://www.sunshine2k.de/articles/coding/crc/understanding_crc.html?utm_source=chatgpt.com "Understanding CRC - Sunshine's Homepage")).

```plaintext
CRC-8 다항식: x^8 + x^2 + x + 1 (0x07)
계산 대상: [0x03, 0x52, 0x00, MessageID]
```

| 번호  | MessageID (HEX) | 데이터 바이트(0x03,0x52,0x00,ID) | 계산된 CRC-8 | 실제 CRC | 일치 여부 |
| :-: | :-------------: | :------------------------: | :-------: | :----: | :---: |
| 01  |      0x31       |        03 52 00 31         |   0x5F    |  0x5F  |  일치   |
| 02  |      0x32       |        03 52 00 32         |   0x56    |  0x56  |  일치   |
| 03  |      0x33       |        03 52 00 33         |   0x51    |  0x51  |  일치   |
| 04  |      0x34       |        03 52 00 34         |   0x44    |  0x44  |  일치   |
| 05  |      0x35       |        03 52 00 35         |   0x43    |  0x43  |  일치   |
| 06  |      0x36       |        03 52 00 36         |   0x4A    |  0x4A  |  일치   |
| 07  |      0x37       |        03 52 00 37         |   0x4D    |  0x4D  |  일치   |
| 08  |      0x38       |        03 52 00 38         |   0x60    |  0x60  |  일치   |
| 09  |      0x39       |        03 52 00 39         |   0x67    |  0x67  |  일치   |
| 11  |      0x31       |        03 52 00 31         |   0x5F    |  0x5F  |  일치   |
| 12  |      0x32       |        03 52 00 32         |   0x56    |  0x56  |  일치   |
