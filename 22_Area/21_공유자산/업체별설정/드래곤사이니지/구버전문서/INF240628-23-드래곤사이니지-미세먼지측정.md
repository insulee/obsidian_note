### 펌웨어 업데이트 및 설정

1. DB502S 컨트롤러 사전작업
	- 컨트롤러의 JP1(2핀 점퍼핀)에 점퍼를 끼우고 전원을 재공급
2. 부트로더/펌웨어 업데이트
	 1. flash_download_tool_3.9.6.exe 실행
		 - chipType: `ESP32S3`
		 - workMode: `develop`
		 - loadMode: `uart`
		 - `OK`
		 - ![[esp32s3_1.png|200]]
	 2. Binary 파일 업로드
		 - ...
		 - 부트로더: `DB502-BOOT V2.0.0.bin`   @ `0x0000`
		 - 펌웨어: `DB502S_08C_02R016C_V2.4.3-USB-드래곤-미세먼지센서.bin `  @ `0x10000`
			 - 데이터파일 형식: `YYYY-MM-DD-M.txt (ex. 2024-08-01-M.txt)`
		 - 수정펌웨어: `DB502S_V2.4.3-USB-드래곤-미세먼지_YY-MM-M-20240825.bin`  @ `0x10000`
			 - 데이터파일 형식: `YYYY-MM-M.txt (ex. 2024-08-M.txt)`
		 - 업로드 경로 옆 체크박스 체크
		 - START
		 - ![[esp32s3_2.png|300]]
3. 표출신호 설정
	- DABITSimulator.exe 실행
		- 고급설정 > 표출신호 설정
		- 표출신호 > `04D-P32D2S21`
		- 전송
		- 닫기
		- ![[simulator_3.png|200]]![[simulator_4.png|250]]
4. 보드기능 설정
	- DABITSimulator.exe 실행
		 - 고급설정 > 보드 기능 설정
		 - 6\. J2(RS232) Baudrate: `9600` (GPS)
		 - 7\. J3(TTL) Baudrate: `19200` (미세먼지 센서)
		 - 전송
		 - 닫기
5. 4핀 케이블을 사용하여 J3 TTL 포트(4핀 커넥터)에 전광판 컨트롤러(DB502)와 미세먼지 센서(DSM101)를 연결
7. 전광판에 표출 문구 색상이 다음과 같이 표출되는지 확인
	- 좋음(하늘색): PM 수치가 0에서 30 사이일 때
	- 보통(녹색): PM 수치가 31에서 80 사이일 때
	- 나쁨(노란색): PM 수치가 81에서 150 사이일 때
	- 매우나쁨(적색): PM 수치가 151 이상일 때

### 작동 테스트 (USB 버전)
1. usb 메모리 포맷
2. usb 메모리를 컨트롤러에 연결
3. 컨트롤러 전원 껐다 다시 공급
4. 다빛채
	 - 전광판 크기 설정 > 세로: `1`, 가로: `4`, 모듈배열방법: `가로형`
	 - 표출신호 설정 > `04D-P32D2S21`
	 - 폰트전송
		 - ENG samsungLEDsign-2024-08-28-2.fnt
		 - KOR 16x16-DABIT(표준).fnt
		 - USER 16x16-Special(표준).fnt
	 - 배경이미지 불러오기 (초록색 ug/m3): `1X4-03B-ugm.bgp`
	 - 업로드
	 - 보드기능설정 > 7. J3(TTL) Baudrate: `19200` (확인)
5. 미세먼지 센서 연결 (TTL)



---
### 관련 문서
- [[PRJ240405-11-드래곤 미세먼지센서(DSM101) v1]]
- DSM101과 컨트롤러 TTL을 연결하는 4핀 핀맵
	- ![[미세먼지센서핀맵1.jpg|200]]![[미세먼지센서핀맵2.jpg|200]]

