---
share_link: https://share.note.sx/4musg8g9#pcoG5EOA3iF/45NGLqETwqHrwiWMdiBnP1BX3omXuvw
share_updated: 2024-12-18T12:08:17+09:00
---
# 전광판 프로토콜 암호화(AES-256) 문서

## 개요

이 문서는 **ROADEE 전광판**의 제어 및 상태 관리를 위한 **AES-256 암호화** 기반 **JSON5 프로토콜**을 설명합니다. 전광판 상태 정보, 텍스트 메시지 제어(실시간 문구 및 페이지 문구), 화면 설정, 펌웨어 업데이트 등 다양한 기능을 포함한 제어 프로토콜을 제공합니다.

## 프로토콜 구조
### 1. AES-256 암호화 개요
- **대칭키 암호화 알고리즘**으로, 동일한 키로 데이터를 암호화하고 복호화합니다.
- **키 길이**: 256비트 (32바이트)
- **블록 크기**: 128비트 (16바이트)

### 2. 암호화 모드
- **CBC (Cipher Block Chaining) 모드**:
    - **장점**:
        - 높은 보안성
        - 동일한 평문이라도 다른 암호문 생성
    - **단점**:
        - 병렬 처리 불가
        - 패딩 필요

### 3. 패딩 방식
- **PKCS7 패딩**:
    - AES는 16바이트 블록 단위로 암호화하므로, 입력 데이터가 16바이트의 배수가 아닐 경우 패딩을 사용하여 16바이트 단위로 맞춥니다.
    **예시**:
    - 패딩이 1바이트 필요할 때:
		```text
		"YELLOW SUBMARINE" -> 패딩 없음
		"YELLOW SUBMARIN" -> 01 추가
		```
        
    - 패딩이 4바이트 필요할 때:
		```text
		"YELLOW SUB" -> 04 04 04 04 추가
		```
        

### 4. 키와 IV 관리

#### AES-256 키 관리:
```cpp
	const uint8_t AES_KEY[32] = {
		0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
		0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
		0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 
		0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F
	};
```

#### 초기화 벡터 (IV) 관리:
``` cpp
	const uint8_t AES_IV[16] = {
		0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
		0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F
	};
```

### 5. Base64 인코딩
암호화된 데이터를 텍스트로 전송하기 위해 **Base64 인코딩**을 사용합니다.

### 6. 보안 고려사항
#### 1. 키 보안 관리 방법 확인 
1. **키 사전 공유 (Pre-shared Key)**
    - 각 디바이스에 고유한 키를 설정하고, 서버에 저장합니다.
2. **서버로부터 키 받아오기**
    - 디바이스가 서버와 보안 연결 후 AES 키를 받아와서 저장합니다.
3. **고정 키 사용**
    - 모든 디바이스에서 동일한 AES 키를 사용하는 방식 (간단하지만 보안 위험이 있음).

#### 2. IV 보안 관리
- **IV 전송**:
    - 암호화된 데이터에 IV를 포함하여 전송하고, 복호화 시 IV를 분리하여 사용합니다.

