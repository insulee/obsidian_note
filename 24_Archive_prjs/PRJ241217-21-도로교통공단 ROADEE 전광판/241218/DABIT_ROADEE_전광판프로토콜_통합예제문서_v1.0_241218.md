---
share_link: https://share.note.sx/dywlhr0b#TApOkIg09dcmdYX5yYRQ5MVRn65RhaMGsbsDmgKEb30
share_updated: 2024-12-18T11:13:39+09:00
---
# 전광판 프로토콜 예제 문서

이 문서는 도로교통관리공단용 전광판 프로토콜(JSON 표준 기반)을 실제 운영 상황에서 어떻게 활용할 수 있는지 보여주는 예제들을 담고 있습니다. 각 예제는 기존 프로토콜 규칙(메시지 유형, 버전, MSG_ID, MOID, RESULT_CODE 등)을 준수하고, 실시간 문구/페이지 문구 설정, GET/SET 요청 및 응답, 피드백 메시지, 에러 처리 등을 시나리오별로 제시합니다. 또한, 메시지를 Publish할 때 사용되는 토픽(`igw/tsc/dev`, `feedback.20` 등)을 표시하여 메시지 흐름을 명확히 합니다.

## 예제 목차
1. [[#1. 토픽 규칙 및 공통 전제|토픽 규칙 및 공통 전제]] 
2. [[#2. 실시간 문구 예제|실시간 문구 예제]]
3. [[#3. 페이지 문구 예제|페이지 문구 예제]]
4. [[#4. GET 요청/응답 예제 (전광판 상태 조회)|GET 요청/응답 예제 (전광판 상태 조회)]]
5. [[#5. SET 요청/응답 예제 (전광판 구성 설정 변경)|SET 요청/응답 예제 (전광판 구성 설정 변경)]]
6. [[#6. 피드백(이벤트) 메시지 예제 전광판 리셋|피드백(이벤트) 메시지 예제: 전광판 리셋]]
7. [[#6. 피드백(이벤트) 메시지 예제 전광판 리셋|에러 상황 예제 (SET 요청 시 잘못된 파라미터)]]
8. [[#8. 텍스트 메시지 초기값 설정|텍스트 메시지 초기값 설정]]
9. [[#9. 페이지 메시지 개수 및 초기화 여부 설정|페이지 메시지 개수 및 초기화 여부 설정]]
---

## 1. 토픽 규칙 및 공통 전제
- **TSC → Device 제어 요청 토픽**: `igw/tsc/dev`  
    TSC(신호제어)에서 디바이스(전광판)로 GET/SET 명령 전송 시 사용
- **Device → TSC 응답 및 피드백 토픽**: `feedback.20`  
    Device(전광판)에서 TSC로 GET_RESPONSE, SET_RESPONSE, FEEDBACK 등을 전송
    우선순위 20은 일반 상황을 가정. 긴급 시 `feedback.10`, 로그성은 `feedback.30` 등으로 확장 가능

---

## 2. 실시간 문구 예제
- TSC가 전광판에 실시간 문구("보행자", "주의", "바랍니다")를 즉시 표시(입장 효과: 좌로 이동)하고 무한 반복하도록 설정
- **토픽(TSC → Device)**: `igw/tsc/dev`
- **SET 요청(JSON)**:
```json
{
  "MSG_TYPE": "SET",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011021000,
  "MOID": {
    "2.RTE058.2.0.1": {
      "1": [1, 99],          // 즉시표시(1), 무한반복(99)
      "2": [20, 0, 50, 10],  // 입장효과(20: 좌로), 퇴장(0), 속도(50), 유지시간(10초)
      "3": [0, 100, 0, 100], // 섹션 전체 영역
      "4": 0,              // 예약 이미지 없음(0)
      "5": [
        ["보행자", 1, 0, 1, 3], // 글자색(1: 빨간색), 배경색(0: 검정색), 폰트그룹(1), 폰트크기(16x16픽셀) 
        ["주의", 3], // 글자색(3: 노란색), 나머지는 기본값 설정
        ["바랍니다"] // 기본값 설정
      ]
    }
  }
}
```

- **SET_RESPONSE(JSON) (Device → TSC)**  
- **토픽(Device → TSC)**: `feedback.20`
```json
{
  "MSG_TYPE": "SET_RESPONSE",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011021000,
  "RESULT_CODE": 0,
  "RESULT_MSG": "OK",
  "RESULT": {
    "2.RTE058.2.0.1": 0
  }
}
```

---

## 3. 페이지 문구 예제
- TSC가 전광판에 페이지 문구("안전", "확인", "부탁드립니다")를 5회 반복 표시(입장효과: 깜빡임)하도록 설정
- **토픽(TSC → Device)**: `igw/tsc/dev`
- **SET 요청(JSON)**:
```json
{
  "MSG_TYPE": "SET",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011022000,
  "MOID": {
    "2.RTE058.2.1.1": {
      "1": [1, 5],          // 즉시표시, 5회 반복
      "2": [30, 0, 40, 15], // 깜빡임(30), 유지시간(15초)
      "3": [10, 90, 20, 80],
      "4": 2,
      "5": [
        ["안전", 2, 0, 2, 7], // 글자색(2: 초록색), 배경색(0: 검정색), 폰트그룹(2), 폰트크기(32x32픽셀) 
        ["확인", 4], // 글자색(4: 파란색), 나머지는 기본값 설정
        ["부탁드립니다"] // 기본갑 설정
      ]
    }
  }
}
```

- **SET_RESPONSE(JSON) (Device → TSC)**  
- **토픽(Device → TSC)**: `feedback.20`
```json
{
  "MSG_TYPE": "SET_RESPONSE",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011022000,
  "RESULT_CODE": 1,
  "RESULT_MSG": "OK",
  "RESULT": {
    "2.RTE058.2.1.1": 0
  }
}
```

---

## 4. GET 요청/응답 예제 (전광판 상태 조회)
- TSC가 전광판 시간, 밝기, 화면, 폰트 정보를 조회(GET)
- **토픽(TSC → Device)**: `igw/tsc/dev`
- **GET 요청(JSON)**:
```json
{
  "MSG_TYPE": "GET",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011015000,
  "MOID": [
    "2.RTE058.3.1",
    "2.RTE058.3.2",
    "2.RTE058.3.3",
    "2.RTE058.3.5"
  ]
}
```

- **GET_RESPONSE(JSON) (Device → TSC)**  
- **토픽(Device → TSC)**: `feedback.20`
```json
{
  "MSG_TYPE": "GET_RESPONSE",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011015000,
  "RESULT_CODE": 1,
  "RESULT_MSG": "OK",
  "RESULT": {
    "2.RTE058.3.2": "2306192123456",
    "2.RTE058.3.3": 50, // 50% 밝기
    "2.RTE058.3.4": [6, 2, 0, 0], // 가로 모듈(6개), 세로 모듈(2개), 단면(0), 가로형기본
    "2.RTE058.3.6": ["ascii.fnt", "unicode.fnt"]
  }
}
```

---

## 5. SET 요청/응답 예제 (전광판 구성 설정 변경)
- TSC가 전광판 화면 설정(가로/세로 모듈)과 밝기(75%)를 변경
- **토픽(TSC → Device)**: `igw/tsc/dev`
- **SET 요청(JSON)**:
```json
{
  "MSG_TYPE": "SET",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011016000,
  "MOID": {
    "2.RTE058.4.3": [8, 2, 0, 0],// 가로 모듈(8개), 세로 모듈(2개), 단면(0), 가로형기본
    "2.RTE058.4.2": 75 // 75% 밝기
  }
}
```

- **SET_RESPONSE(JSON) (Device → TSC)**  
- **토픽(Device → TSC)**: feedback.20
```json
{
  "MSG_TYPE": "SET_RESPONSE",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011016000,
  "RESULT_CODE": 1,
  "RESULT_MSG": "OK",
  "RESULT": {
    "2.RTE058.4.3": 0,
    "2.RTE058.4.2": 0
  }
}
```

---

## 6. 피드백(이벤트) 메시지 예제: 전광판 리셋
- 디바이스(전광판)에서 에러 상태(STATUS=99)를 감지하고 TSC에 피드백
- **토픽(Device → TSC)**: `feedback.20`
- **피드백(JSON)**:
```json
{
  "MSG_TYPE": "FEEDBACK",
  "MSG_VER": 20241108,
  "MSG_ID": 1730011029000,
  "PRIORITY": 10,
  "MOID": {
    "2.RTE058.1": [1727403729, 1, 1727403729, 1727403729] // 상태 요약: 리셋 후 상태
  },
  "DESC": "전광판 리셋 완료", // 리셋 완료 설명
  "TIMESTAMP": 1730011029000  // 리셋 발생 시간 (UNIX 밀리초)
}
```

- **설명**
	- **`MSG_TYPE`:** `"FEEDBACK"` → 피드백 메시지 타입을 지정.
	- **`MSG_VER`:** `20241108` → 메시지 버전.
	- **`MSG_ID`:** `1730011029000` → 이 메시지의 고유 식별자.
	- **`PRIORITY`:** `10` → 우선순위가 높은 피드백 메시지로, 긴급 또는 중요한 이벤트로 간주.
	- **`MOID`:** `"2.RTE058.1"` → MOID는 전광판 상태 요약을 나타내며, 리셋 후 상태를 담고 있습니다. 예시에서는 `1`이 `작동 중` 상태임을 나타냅니다.
		- `1727403729` → 리셋 후 메시지 전송 시간 (UNIX 밀리초)
		- `1` → 상태: 작동 중 (리셋이 완료된 후 정상 작동 중 상태)
		- `1727403729` → 이벤트 발생 시간 (리셋 이벤트 발생 시간)
		- `1727403729` → 데이터 갱신 타입 (UNIX 밀리초)
	- **`DESC`:** `"전광판 리셋 완료"` → 전광판이 리셋되었음을 설명하는 텍스트.
	- **`TIMESTAMP`:** `1730011029000` → 리셋 발생 시간 (UNIX 밀리초로 표시).
---

## 7. 에러 상황 예제 (SET 요청 시 잘못된 파라미터)
- TSC가 폰트 크기 범위를 벗어난 값(99)을 SET 요청.
- **토픽(TSC → Device)**: igw/tsc/dev
- **SET 요청(JSON)**:
```json
{
  "MSG_TYPE": "SET",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011024000,
  "MOID": {
    "2.RTE058.2.0.1": {
      "5": [
        ["테스트", 1, 0, 1, 99]
      ]
    }
  }
}
```

- **SET_RESPONSE(JSON) (Device → TSC)**  
- **토픽(Device → TSC)**: `feedback.20`
```json
{
  "MSG_TYPE": "SET_RESPONSE",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011024000,
  "RESULT_CODE": -1,
  "RESULT_MSG": "Font size error",
  "RESULT": {
    "2.RTE058.2.0.1": 1
  }
}
```

---

## 8. 텍스트 메시지 초기값 설정
- TSC에서 전광판에 초기값 설정 명령을 전송하여 전광판의 기본 설정을 적용
- 이때 텍스트 메시지, 효과 속성, 섹션 위치, 예약 이미지 등도 함께 전송
- **토픽(TSC → Device)**: `igw/tsc/dev`
- **SET 요청(JSON)**:
```json
{
  "MSG_TYPE": "SET",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011027000,
  "MOID": {
    "2.RTE058.4.5": 1,   // 초기값 설정 여부: 1 (초기값 설정)
    "2.RTE058.2.0.1": {
      "1": [1, 99],      // 메시지 화면 표시 설정: 즉시 표시(1), 무한 반복(99)
      "2": [20, 0, 50, 10], // 입장 효과(20: 좌로이동), 퇴장(0), 속도(50), 유지 시간(10초)
      "3": [0, 100, 0, 100], // 섹션 전체 영역
      "4": "1",              // 예약 이미지 번호
      "5": [
        ["", 1, 0, 1, 3], // 설정값이므로 텍스트는 입력하지 않음
      ]
    }
  }
}
```

- **설명**
	- `"2.RTE058.4.5": 1`: 초기값을 설정하며, 전광판에 필요한 메시지 화면 설정과 효과 속성 등도 함께 전송
	- `"2.RTE058.2.0.1"`: 초기값을 설정하는 전광판 설정 항목.
		- `"5"` 필드는 텍스트 메시지, 색상, 폰트 크기 등 속성 값들을 설정하는 데 사용

- **SET_RESPONSE(JSON) (Device → TSC)**  
- **토픽(Device → TSC)**: `feedback.20`
```json
{
  "MSG_TYPE": "SET_RESPONSE",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011027000,
  "RESULT_CODE": 1,
  "RESULT_MSG": "OK",
  "RESULT": {
    "2.RTE058.4.5": 0   // 초기값 설정 성공
  }
}
```

- **설명**:
	- `"2.RTE058.4.5": 0`은 초기값 설정이 성공적으로 적용

---

## 9. 페이지 메시지 개수 및 초기화 여부 설정
- TSC에서 전광판에 사용할 페이지 메시지 개수를 설정하고, 초기화 여부를 지정합니다. 페이지 메시지는 지정된 개수 내에서 사용 가능합니다.
- **토픽(TSC → Device)**: `igw/tsc/dev`
- **SET 요청(JSON)**:
```json
{
  "MSG_TYPE": "SET",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011028000,
  "MOID": {
    "2.RTE058.4.6": [5, 1]  // 페이지 메시지 5개, 초기화
  }
}
```

- **설명**
	- `"2.RTE058.4.6": [5, 1]`: 페이지 메시지 개수 5개로 설정하고, 초기화 여부를 `1`로 설정하여 기존 페이지 메시지 설정을 초기화

- **SET_RESPONSE(JSON) (Device → TSC)**  
- **토픽(Device → TSC)**: `feedback.20`
```json
{
  "MSG_TYPE": "SET_RESPONSE",
  "MSG_VER": 20241028,
  "MSG_ID": 1730011028000,
  "RESULT_CODE": 1,
  "RESULT_MSG": "OK",
  "RESULT": {
    "2.RTE058.4.6": 0  // 페이지 메시지 관련 설정 성공
  }
}
```

- **설명**
	- `"2.RTE058.4.6": 0`은 페이지 메시지 개수 설정이 성공적으로 적용