
---

>[!abstract] 기본정보 
>프로그램: dbProtocolSimulator(V1.0.0)
>컨트롤러: DB600T(V8.8)
>펌웨어: DIBD600T_08C_04R020C_V3.1.4(BL V8.0)-UM-빛샘 수위정보 전광판-2.bin

---
### 1. 서버로부터 DATA 수신이 안될 경우 컨트롤러 소켓 종료
#### Heartbeat 설정
- dbProtocolSimulator(V1.0.0) > 설정 > 통신설정 > dbNet
	- Search > BoardList > 컨트롤러의 맥주소 선택
	- Heartbeat > 숫자 입력
		- `0` : 사용 안 함
		- `1` : 10초 (10sec)
		- `6` : 1분 (60sec, 1min)
		- `360`: 1시간 (3600sec, 1hour)
		- 최대 `999`까지 가능
		- ![[prj_빛샘수위6.png|400]]

</br>

#### 동작 방식
- Heartbeat 설정값에 따라 전광판이 서버에 PING 신호를 전송하여 통신 상태를 확인
	- `1`: 10초 마다 한 번씩 PING 신호 전송
	- `6`: 60초(1분) 마다 한 번씩 PING 신호 전송
- 이때, 10회 연속 서버로부터 응답 또는 수위 정보 패킷이 수신되지 않으면, 통신 연결에 이상이 있는 것으로 판단하여 현재의 소켓 연결을 자동으로 종료(-> 소켓 연결 종료에서 리셋으로 변경)
- 소켓이 종료된 후, 네트워크가 복구되어 서버로부터 정상적인 패킷이 수신되면, 전광판은 해당 패킷을 기반으로 정상 데이터를 표출

---
### 2. 초기문구 추가
- 수위전광판을 통신이 안되는 상태에서 전원을 켜거나, 리셋되고 나서 서버에서 데이터가 오기 전까지 지정 문구를 출력
- 전원을 켜면 모듈 초기화면이 나오는데, 이때 아래와 같이 페이지 문구를 전송하면 수위정보 데이터(실시간문구)가 오기 전까지 해당 문구가 전송
	- 페이지 문구는 한번 전송하면 전원을 껐다 켜도 문구가 유지
	- 페이지 문구 개수 설정(1개): ![006001!]
	- 페이지 문구 전송: ![001/P0000/C2FLOOD FORECASTING & /C1WARNING SYSTEM!]

### 3. 리셋 펌웨어 변경 (2025-03-13)
- `DIBD600T_08C_04R020C_V3.1.4(BL V8.0)-UM-빛샘 수위정보 전광판-20250313_Reset.bin`
- Heartbeat 설정값에 따라 서버에 PING 신호를 전송하여 통신상태 확인
- 10회 연속 서버로부터 응답 또는 수위 정보 패킷이 수신되지 않으면 리셋이 되어 페이지 메세지 전송


%%
참고문서
[[PRJ240909-11-빛샘 수위정보 전광판]]
%%